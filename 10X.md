# 10x Genomics Single Cell 3’V3
处理10x数据
10x Genomics简介：

## 采用的实验数据
本文采用测序样本来源于人类外周血单核细胞、小鼠结肠细胞，以及HEK293-RFP、NIH3T3-GFP、 MDCK-Turbo650三种细胞系的混合。数据来源于[ENA数据库](https://www.ebi.ac.uk/ena/browser/view/PRJNA593571?show=reads) 。由于样本是人鼠混合，所以参考基因组选用的是mix_hg38_mm10。测序方法是10x Genomics 3' V3，能够从单个细胞得到3'端的基因表达文库。经过测序后会得到两个fastq文件，一个是read1，一个是read2。read1文件包含12bp的UMI序列和16bp的细胞条形码序列。read2文件包含3'端测序的cDNA序列。

 ```
#新建并下载实验数据到mereu2020/10xV3文件夹
mkdir -p mereu2020/10xV3
wget -P mereu2020/10xV3 -c ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR105/009/SRR10587809/SRR10587809_1.fastq.gz
wget -P mereu2020/10xV3 -c ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR105/009/SRR10587809/SRR10587809_2.fastq.gz

 ```

## 准备白名单
10x Genomics平台定义了他们所用的凝胶微珠barcode，我们需要用到V3试剂相关的barcode。如果电脑中有CellRanger软件，能够在'lib/python/cellranger/barcodes/'目录下找到 3M-february-2018.txt.gz 文件。如果没有，可以从以下网址下载。
```
wget -P mereu2020/10xV3 wget https://teichlab.github.io/scg_lib_structs/data/3M-february-2018.txt.gz
gunzip mereu2020/10xV3/3M-february-2018.txt.gz
```

## 从FastQ到计数矩阵
输入命令：
```
STAR --runThreadN 4 \
     --genomeDir mix_hg38_mm10/star_index \
     --readFilesCommand zcat \
     --outFileNamePrefix mereu2020/star_outs/ \
     --readFilesIn mereu2020/10xV3/SRR10587809_2.fastq.gz mereu2020/10xV3/SRR10587809_1.fastq.gz \
     --soloType CB_UMI_Simple \
     --soloCBstart 1 --soloCBlen 16 --soloUMIstart 17 --soloUMIlen 12 \
     --soloCBwhitelist mereu2020/10xV3/3M-february-2018.txt \
     --soloCellFilter EmptyDrops_CR \
     --soloStrand Forward \
     --outSAMattributes CB UB \
     --outSAMtype BAM SortedByCoordinate
```

## 相关命令解释
`--runThreadN 4`
>采用四个线程运行程序

`--genomeDir mix_hg38_mm10/star_index`
>指向参考基因组的star目录。我们使用的公开数据是使用HCA参考样本生成的，该参考样本由人 PBMC (60%) 和 HEK293T (6%)、小鼠结肠 (30%)、NIH3T3 (3%) 和狗 MDCK 细胞 (1%) 组成。因此，我们需要使用物种混合参考基因组。但是由于狗的细胞只占1%，这里所选用的参考基因组就不将其纳入考虑。

`--readFilesCommand zcat`
>>>fastq文件是.gz的被压缩状态，所以用zcat来提取内容。

`--outFileNamePrefix mereu2020/star_outs/`
>指向输出文件目录。所有的输出内容都将被放入mereu2020/star_outs/目录下。

`--readFilesIn mereu2020/10xV3/SRR10587809_2.fastq.gz mereu2020/10xV3/SRR10587809_1.fastq.gz`


`--soloType CB_UMI_Simple`

`--soloCBstart 1 --soloCBlen 16 --soloUMIstart 17 --soloUMIlen 12`

`--soloCBwhitelist mereu2020/10xV3/3M-february-2018.txt`

`--soloCellFilter EmptyDrops_CR`

`--soloStrand Forward`

`--outSAMattributes CB UB`

`--outSAMtype BAM SortedByCoordinate`









## 利用seruat进行下一步分析

